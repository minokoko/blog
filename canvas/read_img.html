<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>读取图片</title>
</head>
<body>
<canvas id="canvas" width="500" height="500" style="border: 1px solid black;">
<input id="input" type="file" style="display: none;">
<script type="text/javascript">
	// 为了方便起见，还是用 jQuery 吧
	var canvas = document.getElementById('canvas');
	var input = document.getElementById('input');
	var ctx = canvas.getContext('2d');
	// 通过点击 canvas 触发 input 的 click 事件，用来选择文件
	canvas.addEventListener('click', function(){
	    input.click();
	}, false);
	// 选择文件后，会触发 change 事件
	input.addEventListener('change', function(e){
		// 通过 FileReader 来读取文件
	    var reader = new FileReader();
	    var file = e.target.files[0];
	    // 绑定读取文件后的回调函数
	    reader.onload = function (e) {
	        var img = new Image();
	        var dataURL = e.target.result;
	        // 通过计算可以得到
	        img.onload = function () {
	            var hRatio = canvas.width  / img.width    ;
	            var vRatio =  canvas.height / img.height  ;
	            var ratio  = Math.min ( hRatio, vRatio );
	            var centerShiftX = ( canvas.width - img.width*ratio ) / 2;
	            var centerShiftY = ( canvas.height - img.height*ratio ) / 2;  
	            ctx.clearRect(0, 0, canvas.width, canvas.height);
	            ctx.drawImage(img,
	                0, 0, img.width, img.height, // 原始图像
	                centerShiftX, centerShiftY, img.width*ratio, img.height*ratio); // 目标图像
	      };
	      img.src = dataURL;
	    };
	    // 如果用户在选择文件时点了取消，file 就会为 undefined
	    if (file) {
	        // 读取文件，并返回 DataURL，可以通过 e.target.result 来得到这个 DataURL
	        reader.readAsDataURL(file);
	    }
	}, false);
</script>
</body>
</html>